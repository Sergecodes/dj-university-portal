var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(g){var h=0;return function(){return h<g.length?{done:!1,value:g[h++]}:{done:!0}}};$jscomp.arrayIterator=function(g){return{next:$jscomp.arrayIteratorImpl(g)}};$jscomp.makeIterator=function(g){var h="undefined"!=typeof Symbol&&Symbol.iterator&&g[Symbol.iterator];return h?h.call(g):$jscomp.arrayIterator(g)};$jscomp.arrayFromIterator=function(g){for(var h,r=[];!(h=g.next()).done;)r.push(h.value);return r};
$jscomp.arrayFromIterable=function(g){return g instanceof Array?g:$jscomp.arrayFromIterator($jscomp.makeIterator(g))};
document.addEventListener("DOMContentLoaded",function(){var g={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},h=function(a,b){var e=1,d=setInterval(function(){0>=e&&(e=0,clearInterval(d));a.style.opacity=e;e-=1/(100*b)},10)},r=function(a,b){var e=0,d=setInterval(function(){1<=e&&(e=1,clearInterval(d));a.style.opacity=e;e+=1/(50*b)},20)},C=function(a,b,e,d){d=void 0===d?2:d;switch(b){case -1:b="danger";break;case 0:b="success";break;case 1:b="warning"}b="alert-"+
b;var c=document.createElement("div");c.classList.add("h6");c.classList.add("alert");c.classList.add(b);c.innerHTML=e;a.prepend(c);B(c);r(c,d);setTimeout(function(){h(c,d)},1E3*d);setTimeout(function(){c.remove()},2E3*d)},B=function(a){var b="fixed"===a.style.position;200<a.scrollTop&&!b&&a.setAttribute("style","{'position': 'fixed', 'top': '0px'}");200>a.scrollTop&&b&&a.setAttribute("style","{'position': 'static', 'top': '0px'}")},v=function(a){a.style.display="none";a.querySelector("form").reset();
a.querySelector("textarea").style.display="none"},w=function(a){a.currentTarget.nextElementSibling.style.display="block"},x=function(a){z(a.currentTarget,"remove")},D=function(a){return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")},z=function(a,b){var e=null,d=null;if("add"!==(void 0===b?"add":b)){b="remove";var c=a}else c=a.closest(".report-modal-form-combined").firstElementChild,d=a.querySelector('input[name="reason"]:checked').value,e=a.querySelector("textarea").value;
var p=c.getAttribute("data-url"),k=c.getAttribute("data-app-name"),E=c.getAttribute("data-model-name"),F=c.getAttribute("data-model-id"),G=c.getAttribute("data-csrf");k={app_name:k,model_name:E,model_id:F};d&&(k.reason=d);e&&(k.info=e);e=D(k);g["X-CSRFToken"]=G;fetch(p,{method:"post",headers:g,body:e}).then(function(f){return f.json()}).then(function(f){var l=["user-has-flagged","fas"],q=["user-has-not-flagged","far"],m=c.querySelector(".flag-icon");if(f){C(c.parentElement,f.status,f.msg);var H=c.nextElementSibling;
1===f.flag?(f="add",v(H),c.removeEventListener("click",w),c.addEventListener("click",x)):(f="remove",c.removeEventListener("click",x),c.addEventListener("click",w),A(c));"add"===f?(m.classList.add.apply(m.classList,$jscomp.arrayFromIterable(l)),m.classList.remove.apply(m.classList,$jscomp.arrayFromIterable(q))):(m.classList.remove.apply(m.classList,$jscomp.arrayFromIterable(l)),m.classList.add.apply(m.classList,$jscomp.arrayFromIterable(q)));q=f;c.querySelector("span").querySelector("span");if(l=
document.querySelector(".js-first-child").previousElementSibling)q="add"==q?document.querySelector(".js-remove-flag").textContent:document.querySelector(".js-report-content").textContent,l.textContent=q;l=f;f=c.querySelector("span");f.hasAttribute("title")&&(l="add"==l?document.querySelector(".js-remove-flag").textContent:document.querySelector(".js-report-content").textContent,f.setAttribute("title",l))}})["catch"](function(f){console.error(f);f=document.querySelector(".js-flag-alert-msg").textContent;
displayCustomErrorToast(f)})},A=function(a,b){b=void 0===b?null:b;b||(b=a.nextElementSibling.parentElement);var e=b.querySelector(".flag-report-modal");a.addEventListener("click",w);b.querySelector(".report-modal-close").onclick=function(){v(e)};var d=b.querySelector(".report-modal-form"),c=d.querySelector(".last-flag-reason"),p=d.querySelector(".report-modal-form-info");d.onchange=function(k){k.target.value===c.value?(p.required=!0,p.style.display="block"):(p.style.display="none",p.removeAttribute("required"))};
d.onsubmit=function(k){k.preventDefault();z(d,"add")}},t=document.getElementsByClassName("report-modal-form-combined"),u={};t=$jscomp.makeIterator(t);for(var n=t.next();!n.done;u={$jscomp$loop$prop$modal$3:u.$jscomp$loop$prop$modal$3},n=t.next()){n=n.value;u.$jscomp$loop$prop$modal$3=n.querySelector(".flag-report-modal");window.onclick=function(a){return function(b){b.target==a.$jscomp$loop$prop$modal$3&&v(a.$jscomp$loop$prop$modal$3)}}(u);var y=n.querySelector(".flag-report-icon");y.querySelector(".flag-icon").classList.contains("user-has-not-flagged")?
A(y,n):y.addEventListener("click",x)}});