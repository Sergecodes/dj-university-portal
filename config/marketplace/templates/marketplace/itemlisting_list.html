{% extends "core/base.html" %}

{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load humanize %}
{% load marketplace_extras %}

{% block title %}
	<title>{{ listing.title }}</title>
{% endblock %}

{% block extra_css %}
	<link rel="stylesheet" href="{% static 'css/marketplace.css' %}">
{% endblock extra_css %}

{% block institution_searchbox %}
{% endblock %}

{% block content %}
<!-- 100% wide undil lg. (At lg it turns to container.) -->
<div class="container-lg mb-5 listing-list-container">
	<section class="listing-search-form-wrp">
		<form method="get" class="p-3 listing-search-form">
			<h4>{% trans 'Filter' %}</h4>
			{% with filter.form as form %}
				<div class="row">
					<div class="form-group col-sm-4 col-md-4">
						{{ form.institution|as_crispy_field }}
					</div>
					<div class="form-group col-sm-4 col-md-4">
						{{ form.category|as_crispy_field }}
					</div>
					<div class="form-group col-sm-4 col-md-4">
						{{ form.title|as_crispy_field }}
					</div>
				</div>
			{% endwith %}
			<button type="submit" class="btn btn-primary">
				<i class="fas fa-search"></i>
				{% trans 'Search' %}
			</button>
			
		</form>
	</section>

	<section class="listing-list-wrp">
		<ul class="listing-list">
			{% for listing, photo in filter.qs|zip:first_photos %}
				<li class="d-flex p-3 pb-4 mb-2 post">
					<div class="flex-shrink-0">
						<a href="{{ listing.get_absolute_url }}">
							<img class="py-2 post__img" src="{{ photo.file.url }}" alt="{{ photo.title }}">
						</a>
					</div>
					<div class="flex-grow-1 ms-4">
						<a 
							href="{{ listing.get_absolute_url }}" 
							class="h5 text-decoration-none"
						>
							{{ listing.title }}
						</a>
						<br class="mb-4">
						<a 
							class="text-decoration-none" 
							href="#"
						>
							{{ listing.institution }}
						</a>
						<br class="mb-1">
						<span class="fw-bold">{{ listing.price|intcomma }} FCFA</span>
						<span> | {% trans 'Posted' %} {{ listing.datetime_added|naturaltime }}</span>
					</div>
				</li> 
			{% endfor %}
			{% comment %} {% for listing in filter.qs %}
				{{ listing.title }} - ${{ listing.price }}<br />
			{% endfor %} {% endcomment %}
		</ul>
	</section>
</div>
{% endblock content %}

{% block extra_js %}
<script>
    
</script>
{% endblock %}